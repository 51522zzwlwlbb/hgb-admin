var ae=Object.defineProperty,re=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var H=(e,l,o)=>l in e?ae(e,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[l]=o,v=(e,l)=>{for(var o in l||(l={}))ce.call(l,o)&&H(e,o,l[o]);if(W)for(var o of W(l))de.call(l,o)&&H(e,o,l[o]);return e},Y=(e,l)=>re(e,ie(l));var S=(e,l,o)=>new Promise((w,d)=>{var m=n=>{try{r(o.next(n))}catch(f){d(f)}},p=n=>{try{r(o.throw(n))}catch(f){d(f)}},r=n=>n.done?w(n.value):Promise.resolve(n.value).then(m,p);r((o=o.apply(e,l)).next())});import{d as x,o as i,c as $,a as pe,h as a,ak as q,a1 as J,co as fe,aj as ee,cp as K,ai as _e,r as V,b as me,Y as C,as as ge,cq as be,s as ye,a2 as G,A as b,w as u,i as O,aw as L,ax as Q,b0 as X,aq as A,j,t as M,ap as E,az as ve,aA as Be,N as ke,a4 as Oe,cr as we,m as Pe,cs as Fe,n as he,av as Se,au as Z,bH as Ce,a5 as Ne,l as Ve,a7 as je,ct as Me,cu as Ee,k as De}from"./index.f90bf1ac.js";import{s as ze,p as T,Q as Ue}from"./propTypes.7076f694.js";import{D as Ae}from"./DownOutlined.60187cdf.js";const Re={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Te=pe("path",{d:"M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 0 0 140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z",fill:"currentColor"},null,-1),$e=[Te],Ie=x({name:"UpOutlined",render:function(l,o){return i(),$("svg",Re,$e)}});function Ge(e){return e==="NInput"?"\u8BF7\u8F93\u5165":["NPicker","NSelect","NCheckbox","NRadio","NSwitch","NDatePicker","NTimePicker"].includes(e)?"\u8BF7\u9009\u62E9":""}function Le({emit:e,getProps:l,formModel:o,getSchema:w,formElRef:d,defaultFormModel:m,loadingSub:p,handleFormValues:r}){function n(){return S(this,null,function*(){var s;return(s=a(d))==null?void 0:s.validate()})}function f(s){return S(this,null,function*(){s&&s.preventDefault(),p.value=!0;const{submitFunc:y}=a(l);if(y&&q(y)){yield y();return}if(!!a(d))try{yield n(),p.value=!1,e("submit",o);return}catch(k){p.value=!1;return}})}function P(){return S(this,null,function*(){var s;yield(s=a(d))==null?void 0:s.restoreValidation()})}function D(){return S(this,null,function*(){const{resetFunc:s,submitOnReset:y}=a(l);if(s&&q(s)&&(yield s()),!a(d))return;Object.keys(o).forEach(N=>{o[N]=a(m)[N]||null}),yield P();const k=r(J(a(o)));e("reset",k),y&&(yield f())})}function z(){return a(d)?r(J(a(o))):{}}function B(s){return S(this,null,function*(){const y=a(w).map(g=>g.field).filter(Boolean);Object.keys(s).forEach(g=>{const k=s[g];y.includes(g)&&(o[g]=k)})})}return{handleSubmit:f,validate:n,resetFields:D,getFieldsValue:z,clearValidate:P,setFieldsValue:B}}function Qe({defaultFormModel:e,getSchema:l,formModel:o}){function w(m){if(!fe(m))return{};const p={};for(const r of Object.entries(m)){let[,n]=r;const[f]=r;!f||ee(n)&&n.length===0||q(n)||K(n)||(_e(n)&&(n=n.trim()),ze(p,f,n))}return p}function d(){const m=a(l),p={};m.forEach(r=>{const{defaultValue:n}=r;K(n)||(p[r.field]=n,o[r.field]=n)}),e.value=p}return{handleFormValues:w,initDefault:d}}const qe={labelWidth:{type:[Number,String],default:80},schemas:{type:[Array],default:()=>[]},layout:{type:String,default:"inline"},inline:{type:Boolean,default:!1},size:{type:String,default:"medium"},labelPlacement:{type:String,default:"left"},isFull:{type:Boolean,default:!0},showActionButtonGroup:T.bool.def(!0),showResetButton:T.bool.def(!0),resetButtonOptions:Object,showSubmitButton:T.bool.def(!0),submitButtonOptions:Object,showAdvancedButton:T.bool.def(!0),submitButtonText:{type:String,default:"\u67E5\u8BE2"},resetButtonText:{type:String,default:"\u91CD\u7F6E"},gridProps:Object,giProps:Object,baseGridStyle:{type:Object},collapsed:{type:Boolean,default:!1},collapsedRows:{type:Number,default:1}},We=x({name:"BasicForm",components:{DownOutlined:Ae,UpOutlined:Ie,QuestionCircleOutlined:Ue},props:v({},qe),emits:["reset","submit","register"],setup(e,{emit:l,attrs:o}){const w=V({}),d=me({}),m=V({}),p=V(null),r=V(null),n=V(!0),f=V(!1),P=C(()=>Object.assign({size:e.size,type:"primary"},e.submitButtonOptions)),D=C(()=>Object.assign({size:e.size,type:"default"},e.resetButtonOptions));function z(_){var h;const F=(h=_.componentProps)!=null?h:{},U=_.component;return v({clearable:!0,placeholder:Ge(a(U))},F)}const B=C(()=>{const _=v(v({},e),a(m)),F={rules:{}};return(_.schemas||[]).forEach(h=>{h.rules&&ee(h.rules)&&(F.rules[h.field]=h.rules)}),v(v({},_),a(F))}),s=C(()=>{const{layout:_}=a(B);return _==="inline"}),y=C(()=>{const{gridProps:_}=a(B);return Y(v({},_),{collapsed:s.value?n.value:!1,responsive:"screen"})}),g=C(()=>v(v(v({},o),e),a(B))),k=C(()=>{const _=a(p)||a(B).schemas;for(const F of _){const{defaultValue:U}=F;U&&(F.defaultValue=U)}return _}),{handleFormValues:N,initDefault:I}=Qe({defaultFormModel:w,getSchema:k,formModel:d}),{handleSubmit:R,validate:t,resetFields:c,getFieldsValue:te,clearValidate:ne,setFieldsValue:oe}=Le({emit:l,getProps:B,formModel:d,getSchema:k,formElRef:r,defaultFormModel:w,loadingSub:f,handleFormValues:N});function le(){n.value=!n.value}function se(_){return S(this,null,function*(){m.value=be(a(m)||{},_)})}const ue={getFieldsValue:te,setFieldsValue:oe,resetFields:c,validate:t,clearValidate:ne,setProps:se,submit:R};return ge(()=>{I(),l("register",ue)}),{formElRef:r,formModel:d,getGrid:y,getProps:B,getBindValue:g,getSchema:k,getSubmitBtnOptions:P,getResetBtnOptions:D,handleSubmit:R,resetFields:c,loadingSub:f,isInline:s,getComponentProps:z,unfoldToggle:le}}});function He(e,l,o,w,d,m){const p=G("QuestionCircleOutlined"),r=ke,n=Ne,f=Ve,P=Oe,D=je,z=Me,B=Ee,s=De,y=we,g=Pe,k=G("DownOutlined"),N=G("UpOutlined"),I=Fe,R=he;return i(),b(R,A(e.getBindValue,{model:e.formModel,ref:"formElRef"}),{default:u(()=>[O(I,ve(Be(e.getGrid)),{default:u(()=>[(i(!0),$(Q,null,L(e.getSchema,t=>(i(),b(y,A(t.giProps,{key:t.field}),{default:u(()=>[O(s,{label:t.label,path:t.field},Se({default:u(()=>[t.slot?Z(e.$slots,t.slot,{key:0,model:e.formModel,field:t.field,value:e.formModel[t.field]},void 0,!0):t.component==="NCheckbox"?(i(),b(D,{key:1,value:e.formModel[t.field],"onUpdate:value":c=>e.formModel[t.field]=c},{default:u(()=>[O(P,null,{default:u(()=>[(i(!0),$(Q,null,L(t.componentProps.options,c=>(i(),b(f,{key:c.value,value:c.value,label:c.label},null,8,["value","label"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])):t.component==="NRadioGroup"?(i(),b(B,{key:2,value:e.formModel[t.field],"onUpdate:value":c=>e.formModel[t.field]=c},{default:u(()=>[O(P,null,{default:u(()=>[(i(!0),$(Q,null,L(t.componentProps.options,c=>(i(),b(z,{key:c.value,value:c.value},{default:u(()=>[j(M(c.label),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])):t.component?(i(),b(Ce(t.component),A({key:3},e.getComponentProps(t),{value:e.formModel[t.field],"onUpdate:value":c=>e.formModel[t.field]=c,class:{isFull:t.isFull!=!1&&e.getProps.isFull}}),null,16,["value","onUpdate:value","class"])):E("",!0),t.suffix?Z(e.$slots,t.suffix,{key:4,model:e.formModel,field:t.field,value:e.formModel[t.field]},void 0,!0):E("",!0)]),_:2},[t.labelMessage?{name:"label",fn:u(()=>[j(M(t.label)+" ",1),O(n,{trigger:"hover",style:X(t.labelMessageStyle)},{trigger:u(()=>[O(r,{size:"18",class:"text-gray-400 cursor-pointer align-sub"},{default:u(()=>[O(p)]),_:1})]),default:u(()=>[j(" "+M(t.labelMessage),1)]),_:2},1032,["style"])]),key:"0"}:void 0]),1032,["label","path"])]),_:2},1040))),128)),e.getProps.showActionButtonGroup?(i(),b(y,{key:0,suffix:!0,class:"flex items-baseline justify-end h-full"},{default:u(({overflow:t})=>[O(P,{align:"center",justify:e.isInline?"end":"start",style:X({"margin-left":`${e.isInline?12:e.getProps.labelWidth}px`})},{default:u(()=>[e.getProps.showSubmitButton?(i(),b(g,A({key:0},e.getSubmitBtnOptions,{onClick:e.handleSubmit,loading:e.loadingSub}),{default:u(()=>[j(M(e.getProps.submitButtonText),1)]),_:1},16,["onClick","loading"])):E("",!0),e.getProps.showResetButton?(i(),b(g,A({key:1},e.getResetBtnOptions,{onClick:e.resetFields}),{default:u(()=>[j(M(e.getProps.resetButtonText),1)]),_:1},16,["onClick"])):E("",!0),e.isInline&&e.getProps.showAdvancedButton?(i(),b(g,{key:2,type:"primary",text:"","icon-placement":"right",onClick:e.unfoldToggle},{icon:u(()=>[t?(i(),b(r,{key:0,size:"14",class:"unfold-icon"},{default:u(()=>[O(k)]),_:1})):(i(),b(r,{key:1,size:"14",class:"unfold-icon"},{default:u(()=>[O(N)]),_:1}))]),default:u(()=>[j(" "+M(t?"\u5C55\u5F00":"\u6536\u8D77"),1)]),_:2},1032,["onClick"])):E("",!0)]),_:2},1032,["justify","style"])]),_:1})):E("",!0)]),_:3},16)]),_:3},16,["model"])}const Ze=ye(We,[["render",He],["__scopeId","data-v-b8eaf94a"]]);export{Ze as B};
